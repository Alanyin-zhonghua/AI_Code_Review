# AI Code Review é¡¹ç›®æ–‡ä»¶ç»“æ„è¯¦è§£

```
AI_Code_Review/
â”‚
â”œâ”€â”€ ğŸ“ agent_core/                          # æ ¸å¿ƒä»£ç åŒ…
â”‚   â”œâ”€â”€ __init__.py                         # åŒ…åˆå§‹åŒ–æ–‡ä»¶
â”‚   â”œâ”€â”€ .env                                # ç¯å¢ƒå˜é‡é…ç½®ï¼ˆåŒ…å«APIå¯†é’¥ï¼Œå·²ä»gitç§»é™¤ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ config/                          # é…ç½®ç®¡ç†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py                     
â”‚   â”‚   â””â”€â”€ settings.py                     # é…ç½®ç±»ï¼ŒåŠ è½½.envå’Œç¯å¢ƒå˜é‡
â”‚   â”‚                                       # æä¾›Settingså•ä¾‹ï¼Œç®¡ç†æ‰€æœ‰é…ç½®é¡¹
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ domain/                          # é¢†åŸŸæ¨¡å‹ï¼ˆæ ¸å¿ƒä¸šåŠ¡å®ä½“ï¼‰
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ models.py                       # èŠå¤©ç›¸å…³æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚                                   # - ChatMessage: èŠå¤©æ¶ˆæ¯
â”‚   â”‚   â”‚                                   # - ChatRequest: è¯·æ±‚æ¨¡å‹
â”‚   â”‚   â”‚                                   # - ChatResult: å“åº”æ¨¡å‹
â”‚   â”‚   â”‚                                   # - ChatUsage: Tokenä½¿ç”¨ç»Ÿè®¡
â”‚   â”‚   â”œâ”€â”€ conversation.py                 # ä¼šè¯å’Œæ¶ˆæ¯è®°å½•æ¨¡å‹
â”‚   â”‚   â”‚                                   # - Conversation: ä¼šè¯å®ä½“
â”‚   â”‚   â”‚                                   # - MessageRecord: æ¶ˆæ¯å­˜å‚¨è®°å½•
â”‚   â”‚   â”‚                                   # - ConversationStore: å­˜å‚¨æ¥å£åè®®
â”‚   â”‚   â””â”€â”€ exceptions.py                   # ç»Ÿä¸€å¼‚å¸¸å®šä¹‰
â”‚   â”‚                                       # - BusinessError: ä¸šåŠ¡å¼‚å¸¸åŸºç±»
â”‚   â”‚                                       # - NetworkError, ApiErrorç­‰å­ç±»
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ infrastructure/                  # åŸºç¡€è®¾æ–½å±‚
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ ğŸ“ logging/                     # æ—¥å¿—æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â””â”€â”€ logger.py                   # ç»“æ„åŒ–JSONæ—¥å¿—å®ç°
â”‚   â”‚   â”‚                                   # æ”¯æŒæ•æ„Ÿä¿¡æ¯è„±æ•ã€æ—¥å¿—è½®è½¬
â”‚   â”‚   â””â”€â”€ ğŸ“ storage/                     # æŒä¹…åŒ–å­˜å‚¨
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ json_store.py               # JSONæ–‡ä»¶å­˜å‚¨å®ç°
â”‚   â”‚       â”‚                               # å°†ä¼šè¯å’Œæ¶ˆæ¯å­˜å‚¨ä¸º.jsonlæ ¼å¼
â”‚   â”‚       â””â”€â”€ sqlite_store.py             # SQLiteå­˜å‚¨ï¼ˆé¢„ç•™éª¨æ¶ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ providers/                       # AI Provideræ¥å…¥å±‚
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base.py                         # ProviderClientåè®®å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ registry.py                     # Providerå’Œæ¨¡å‹é…ç½®
â”‚   â”‚   â”‚                                   # å®šä¹‰KIMI_CONFIGç­‰é…ç½®
â”‚   â”‚   â””â”€â”€ kimi_client.py                  # Kimi APIå®¢æˆ·ç«¯å®ç°
â”‚   â”‚                                       # å¤„ç†HTTPè¯·æ±‚ã€å“åº”è§£æã€é”™è¯¯å¤„ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ tools/                           # å·¥å…·ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ definitions.py                  # å·¥å…·æ•°æ®ç»“æ„å®šä¹‰
â”‚   â”‚   â”‚                                   # - ToolDef: å·¥å…·å®šä¹‰
â”‚   â”‚   â”‚                                   # - ToolCall: å·¥å…·è°ƒç”¨
â”‚   â”‚   â”‚                                   # - ToolResult: å·¥å…·ç»“æœ
â”‚   â”‚   â””â”€â”€ executor.py                     # å·¥å…·æ‰§è¡Œå™¨
â”‚   â”‚                                       # å®ç°read_fileã€list_filesã€
â”‚   â”‚                                       # search_codeã€propose_editç­‰å·¥å…·
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ agents/                          # Agentå¼•æ“
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base_agent.py                   # Agentæ ¸å¿ƒå¼•æ“
â”‚   â”‚   â”‚                                   # - å¯¹è¯è·¯å¾„æ„å»ºå’Œè£å‰ª
â”‚   â”‚   â”‚                                   # - ä¸Šä¸‹æ–‡ç®¡ç†ï¼ˆæœ€è¿‘Næ¡æ¶ˆæ¯ï¼‰
â”‚   â”‚   â”‚                                   # - å·¥å…·è°ƒç”¨å¾ªç¯
â”‚   â”‚   â”‚                                   # - Providerè°ƒç”¨å°è£…
â”‚   â”‚   â””â”€â”€ ide_helper_agent.py             # IDEåŠ©æ‰‹AgentåŒ…è£…ç±»
â”‚   â”‚                                       # æä¾›ä¾¿æ·æ¥å£ï¼Œé¢„è®¾IDEåŠ©æ‰‹é…ç½®
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ prompts/                         # æç¤ºè¯æ¨¡æ¿
â”‚   â”‚   â”œâ”€â”€ __init__.py                     # æç¤ºè¯åŠ è½½å‡½æ•°
â”‚   â”‚   â””â”€â”€ ğŸ“ zh/                          # ä¸­æ–‡æç¤ºè¯
â”‚   â”‚       â””â”€â”€ ide_helper_system.md        # IDEåŠ©æ‰‹ç³»ç»Ÿæç¤ºè¯
â”‚   â”‚                                       # å®šä¹‰è§’è‰²ã€èƒ½åŠ›ã€è¡Œä¸ºå‡†åˆ™
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ api/                             # å¯¹å¤–APIæ¥å£
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ service.py                      # æœåŠ¡å±‚å‡½æ•°æ¥å£
â”‚   â”‚                                       # - run_ide_chat(): è¿è¡Œå¯¹è¯
â”‚   â”‚                                       # - list_conversations(): åˆ—å‡ºä¼šè¯
â”‚   â”‚                                       # - get_conversation_messages(): è·å–æ¶ˆæ¯
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ gui/                             # å›¾å½¢ç•Œé¢
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ test_gui.py                     # Tkinter GUIæµ‹è¯•åº”ç”¨
â”‚   â”‚                                       # å®Œæ•´çš„å¯¹è¯ç•Œé¢ï¼Œæ”¯æŒä¼šè¯ç®¡ç†
â”‚   â”‚                                       # å·¥å…·æµ‹è¯•ã€æ¶ˆæ¯æµè§ˆç­‰åŠŸèƒ½
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ tests/                           # å•å…ƒæµ‹è¯•
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ test_agent_flow.py              # Agentå·¥ä½œæµæµ‹è¯•
â”‚       â”œâ”€â”€ test_conversation.py            # ä¼šè¯æ¨¡å‹æµ‹è¯•
â”‚       â”œâ”€â”€ test_ide_helper_agent.py        # IDEåŠ©æ‰‹Agentæµ‹è¯•
â”‚       â”œâ”€â”€ test_json_store.py              # JSONå­˜å‚¨æµ‹è¯•
â”‚       â”œâ”€â”€ test_kimi_client.py             # Kimiå®¢æˆ·ç«¯æµ‹è¯•
â”‚       â””â”€â”€ test_tools.py                   # å·¥å…·ç³»ç»Ÿæµ‹è¯•
â”‚
â”œâ”€â”€ ğŸ“ å…¶ä»–/                                # å‚è€ƒæ–‡æ¡£
â”‚   â”œâ”€â”€ bigmodel.md                         # æ™ºè°±AIç›¸å…³æ–‡æ¡£
â”‚   â””â”€â”€ moonshot.md                         # Moonshot APIæ–‡æ¡£
â”‚
â”œâ”€â”€ ğŸ“ .trae/                               # å¼€å‘æ–‡æ¡£ï¼ˆå†å²è®°å½•ï¼‰
â”‚   â””â”€â”€ ğŸ“ documents/
â”‚       â”œâ”€â”€ å®ç°åº•å±‚ AGENT ç³»ç»Ÿ v1.0ï¼ˆæŒ‰è§„æ ¼æ–‡æ¡£ï¼‰.md
â”‚       â”œâ”€â”€ æŒ‰äº§å“ä¹¦å®ç°åº•å±‚ AGENT ç³»ç»Ÿ v1.0ï¼ˆå®æ–½è®¡åˆ’ï¼‰.md
â”‚       â”œâ”€â”€ æŒ‰äº§å“ä¹¦è¡¥å…¨ä¸å¼ºåŒ–åº•å±‚ AGENT v1.0.md
â”‚       â””â”€â”€ å®ŒæˆéªŒè¯ä¸ä½¿ç”¨æŒ‡å—åŠä¸‹ä¸€æ­¥æ‰©å±•.md
â”‚
â”œâ”€â”€ .gitignore                              # Gitå¿½ç•¥æ–‡ä»¶é…ç½®
â”œâ”€â”€ .env.example                            # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ README.md                               # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ requirements.txt                        # Pythonä¾èµ–åˆ—è¡¨
â”œâ”€â”€ run_gui.py                              # GUIå¯åŠ¨è„šæœ¬
â”œâ”€â”€ æµ‹è¯•.py                                 # ä¸´æ—¶æµ‹è¯•æ–‡ä»¶ï¼ˆæ™ºè°±AIç¤ºä¾‹ï¼‰
â””â”€â”€ agent_product_book_v_0.md               # äº§å“æŠ€æœ¯è§„æ ¼æ–‡æ¡£ï¼ˆæ ¸å¿ƒè®¾è®¡æ–‡æ¡£ï¼‰

ğŸ“ åŠ¨æ€ç”Ÿæˆçš„ç›®å½•ï¼ˆ.gitignoreå·²æ’é™¤ï¼‰ï¼š
â”œâ”€â”€ .storage/                               # ä¼šè¯å’Œæ¶ˆæ¯å­˜å‚¨ç›®å½•
â”‚   â””â”€â”€ conversations/                      # æ¯ä¸ªä¼šè¯ä¸€ä¸ªå­ç›®å½•
â”‚       â””â”€â”€ {conversation_id}/
â”‚           â”œâ”€â”€ meta.json                   # ä¼šè¯å…ƒæ•°æ®
â”‚           â””â”€â”€ messages.jsonl              # æ¶ˆæ¯è®°å½•ï¼ˆæ¯è¡Œä¸€ä¸ªJSONï¼‰
â”‚
â”œâ”€â”€ logs/                                   # æ—¥å¿—æ–‡ä»¶ç›®å½•
â”‚   â””â”€â”€ agent.log                           # ç»“æ„åŒ–JSONæ—¥å¿—
â”‚
â””â”€â”€ venv/                                   # Pythonè™šæ‹Ÿç¯å¢ƒ
```

## ğŸ“Š æ ¸å¿ƒæ¶æ„è¯´æ˜

### 1ï¸âƒ£ æ•°æ®æµå‘
```
ç”¨æˆ·è¾“å…¥ 
  â†“
api/service.py (å¯¹å¤–æ¥å£)
  â†“
agents/ide_helper_agent.py (AgentåŒ…è£…)
  â†“
agents/base_agent.py (æ ¸å¿ƒå¼•æ“)
  â†“
â”œâ”€â†’ infrastructure/storage (è¯»å–å†å²æ¶ˆæ¯)
â”œâ”€â†’ prompts (åŠ è½½ç³»ç»Ÿæç¤ºè¯)
â”œâ”€â†’ providers/kimi_client.py (è°ƒç”¨AI)
â””â”€â†’ tools/executor.py (æ‰§è¡Œå·¥å…·ï¼Œå¯é€‰)
  â†“
infrastructure/storage (ä¿å­˜æ–°æ¶ˆæ¯)
  â†“
è¿”å›ç»“æœç»™ç”¨æˆ·
```

### 2ï¸âƒ£ åˆ†å±‚è®¾è®¡
- **Domainå±‚**: æ ¸å¿ƒä¸šåŠ¡æ¨¡å‹ï¼Œä¸ä¾èµ–å¤–éƒ¨
- **Infrastructureå±‚**: åŸºç¡€è®¾æ–½ï¼ˆå­˜å‚¨ã€æ—¥å¿—ï¼‰
- **Providerså±‚**: å¤–éƒ¨AIæœåŠ¡æ¥å…¥
- **Agentså±‚**: ä¸šåŠ¡é€»è¾‘åè°ƒ
- **APIå±‚**: å¯¹å¤–æ¥å£å°è£…
- **GUIå±‚**: ç”¨æˆ·ç•Œé¢ï¼ˆå¯é€‰ï¼‰

### 3ï¸âƒ£ å…³é”®ç‰¹æ€§
- âœ… Gitæ ‘çŠ¶ä¼šè¯ç»“æ„ï¼ˆæ”¯æŒåˆ†å‰å¯¹è¯ï¼‰
- âœ… ä¸Šä¸‹æ–‡è‡ªåŠ¨è£å‰ªï¼ˆæœ€è¿‘Næ¡æ¶ˆæ¯ï¼‰
- âœ… å·¥å…·è°ƒç”¨å¾ªç¯ï¼ˆæœ€å¤š5è½®ï¼‰
- âœ… ç»“æ„åŒ–æ—¥å¿—ï¼ˆJSONæ ¼å¼ï¼Œæ”¯æŒè„±æ•ï¼‰
- âœ… å®‰å…¨çš„è·¯å¾„éªŒè¯ï¼ˆé˜²æ­¢ç›®å½•éå†ï¼‰
- âœ… å®Œæ•´çš„å•å…ƒæµ‹è¯•è¦†ç›–

### 4ï¸âƒ£ é…ç½®æ–‡ä»¶
- `.env`: å®é™…é…ç½®ï¼ˆä¸æäº¤åˆ°gitï¼‰
- `.env.example`: é…ç½®æ¨¡æ¿
- `agent_product_book_v_0.md`: å®Œæ•´æŠ€æœ¯è§„æ ¼

### 5ï¸âƒ£ è¿è¡Œæ–¹å¼
```powershell
# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# é…ç½®APIå¯†é’¥
cp .env.example .env
# ç¼–è¾‘.envï¼Œå¡«å…¥KIMI_API_KEY

# è¿è¡Œæµ‹è¯•
pytest agent_core/tests/ -v

# å¯åŠ¨GUI
python run_gui.py

# æˆ–é€šè¿‡APIè°ƒç”¨
python -c "from agent_core.api.service import run_ide_chat; print(run_ide_chat('ä½ å¥½'))"
```
